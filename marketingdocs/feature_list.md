## Directory Consolidator — список возможностей

### Функциональные возможности
- **Интерактивный выбор директорий.** Поочерёдный ввод произвольного числа исходных папок (до 100 000) с автодополнением и завершением по пустой строке; вложенные комбинации блокируются сразу.
- **Гарантированно чистый результат.** Приложение требует выбрать пустую папку назначения или подтверждает автоматическое удаление её содержимого перед стартом, чтобы исключить артефакты прошлых запусков.
- **Инвентаризация перед консолидацией.** Утилита заранее обходится по дереву файлов, фиксирует относительные пути и корень происхождения, чтобы рассчитать объём работы и корректно строить прогресс.
- **Хэш-детектирование дубликатов.** Каждый файл считывается потоково и хэшируется по SHA-256; если хэш уже встречался, копирование пропускается, а событие отражается в логе.
- **Разрешение конфликтов имён.** При совпадении относительных путей, но различном содержимом к имени файла добавляется датовый модификатор прямо к полному имени (`name.ext__YYMMDD`, при конфликте столетий → `__YYYYMMDD`, затем `-HH`, `-MM`, `-SS`, далее счётчик), поэтому версии легко различить и восстановить хронологию.
- **Автоочистка названий.** Если в исходном имени есть `copy`, инструмент предпочитает элегантный вариант без этого слова (сохраняя расширение) и лишь затем добавляет датовый суффикс при необходимости.
- **Выбор лучшего имени для дубликатов.** Если несколько файлов имеют одинаковый хэш, в результате остаётся копия с самым длинным очищенным именем (при равенстве — лексикографически максимальная без учёта регистра), остальные фиксируются в логе.
- **Повторные попытки и логирование.** Каждая операция чтения/копирования выполняется с до 5 повторов и экспоненциальной задержкой; недоступные пути сохраняются в `consolidator_errors.log`, а консолидация продолжается дальше.
- **Копирование с сохранением метаданных.** Передача выполняется через `shutil.copy2`, что сохраняет временные метки и права доступа, если они поддерживаются файловой системой.
- **Удаление пустых папок.** После завершения копирования инструмент удаляет пустые директории в результирующем дереве, чтобы структуру не засоряли лишние уровни.
- **Статистика и логирование.** В консоли отображается прогресс-бар, статус операций и имя каждого обрабатываемого файла; по завершении выводится статистика по обработанным, пропущенным и скопированным объектам.
- **Standalone-доставка.** Скрипт `scripts/build_executable.sh` собирает PyInstaller-бинарь под arm64 или x86_64, а затем формирует universal2 через `lipo`, поэтому пользователям можно отдавать один файл без установленного Python.

### Нефункциональные качества
- **Точность и верификация.** Использование SHA-256 и автоматического сценария `scripts/smoke_accuracy.py` подтверждает, что результат содержит полный набор уникальных файлов без дубликатов и пустых директорий.
- **Прозрачный пользовательский опыт.** Интерфейс командной строки с подсказками и валидацией путей защищает от ошибок выбора и делает процесс понятным даже без навыков скриптинга.
- **Безопасность данных.** Перед очисткой целевой папки инструмент запрашивает подтверждение, предотвращая случайное удаление нужных файлов.
- **Расширяемость кода.** Логика вынесена в модуль `consolidator` с типизированными помощниками, что упрощает добавление автоматизации или интеграцию в другие пайплайны.
- **Документированность процесса.** README, архитектурная заметка и руководство по тестированию описывают поведение приложения и методику контроля точности, что упрощает онбординг команд.
- **Прозрачные релизы.** Для PyInstaller-сборок публикуются SHA-256 и smoke-логи (см. README и `docs/smoke_runs`), поэтому пользователи могут верифицировать артефакты офлайн.
- **Портативность.** Инструмент ставится через `pip install .` на Python 3.10+ либо поставляется как PyInstaller-бинарь (arm64, x86_64, universal2), поэтому подходит и для офлайн-сценариев.
- **Поддержка Unicode.** Имена файлов и директорий в любых алфавитах (русский, китайский и т. д.) сохраняются без переименований и остаются читабельными в результате.
